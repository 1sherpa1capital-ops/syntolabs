import{a as s,j as l}from"./vendor-B_0GWohW.js";import{S as J,P as K,W as Q,G as Z,m as re,E as ne,M as z,C as q,e as I,n as se,L as ae,o as oe,p as ce,q as ie,r as le,s as Y,t as ue,B as de,a as me,b as pe,A as fe,c as he,R as we}from"./three-C7tQifid.js";import{t as xe}from"./threeUtils-wIMy6wkn.js";const ve=({dataPoints:p,labels:d,color:M="#6366f1",height:F="300px"})=>{const r=s.useRef(null),[y,N]=s.useState(-1),w=s.useRef(null),x=s.useRef(null),m=s.useRef(null),R=s.useRef(null),a=s.useRef({bars:[],particles:null,gridHelper:null}),v=s.useRef(new ie),P=s.useRef(0),E=s.useRef(0),S=s.useRef(null);return s.useEffect(()=>{if(!r.current)return;const j=new J;w.current=j;const u=new K(60,r.current.clientWidth/r.current.clientHeight,.1,1e3);u.position.set(0,15,30),u.lookAt(0,5,0),m.current=u;const A=new Q({antialias:!0,alpha:!0,powerPreference:"high-performance"});A.setSize(r.current.clientWidth,r.current.clientHeight),A.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.current.appendChild(A.domElement),x.current=A;const b=new Z;j.add(b);const f=new le(40,20,4473924,2236962);f.position.y=0,b.add(f),a.current.gridHelper=f;const c=2,n=1,k=-(p.length*(c+n))/2+c/2,W=new q(M),C=[];p.forEach((e,o)=>{const i=Math.max(e,2),t=new Y(c,i,c),h=new z({color:W,transparent:!0,opacity:.8}),g=new I(t,h);g.position.x=k+o*(c+n),g.position.y=i/2,g.position.z=0,g.userData={index:o,value:e,originalScale:1},C.push(g),b.add(g);const ee=new Y(c+.2,i+.2,c+.2),te=new z({color:W,transparent:!0,opacity:.2,side:ue}),U=new I(ee,te);U.position.copy(g.position),g.add(U)}),a.current.bars=C;const G=100,L=new de,D=new Float32Array(G*3),H=new Float32Array(G*3);for(let e=0;e<G;e++){const o=Math.floor(Math.random()*p.length),i=C[o],t=i.userData.value;H[e*3]=i.position.x+(Math.random()-.5)*c,H[e*3+1]=t+Math.random()*5+2,H[e*3+2]=(Math.random()-.5)*c,D[e*3]=(Math.random()-.5)*50,D[e*3+1]=Math.random()*30,D[e*3+2]=(Math.random()-.5)*30}S.current=H,L.setAttribute("position",new me(D,3));const _=new pe({color:W,size:.15,transparent:!0,opacity:.6,blending:fe}),T=new he(L,_);b.add(T),a.current.particles=T;const V=new we,X=xe(e=>{if(!r.current)return;const o=r.current.getBoundingClientRect();v.current.x=(e.clientX-o.left)/o.width*2-1,v.current.y=-((e.clientY-o.top)/o.height)*2+1,V.setFromCamera(v.current,u);const i=V.intersectObjects(C);if(i.length>0){const t=i[0].object.userData.index;N(t)}else N(-1)},16);r.current.addEventListener("mousemove",X);const $=()=>{if(R.current=requestAnimationFrame($),P.current+=.01,E.current++,C.forEach((e,o)=>{const t=o===y?1.1:1;e.scale.y+=(t-e.scale.y)*.1,e.position.y=e.userData.value*e.scale.y/2+Math.sin(P.current+o*.5)*.1}),E.current%2===0&&a.current.particles&&S.current){const e=a.current.particles.geometry.attributes.position.array,o=S.current;for(let i=0;i<G;i++){const t=i*3;e[t]+=(o[t]-e[t])*.02,e[t+1]+=(o[t+1]-e[t+1])*.02,e[t+2]+=(o[t+2]-e[t+2])*.02,e[t+1]+=Math.sin(P.current*2+i*.1)*.01}a.current.particles.geometry.attributes.position.needsUpdate=!0}b.rotation.y=Math.sin(P.current*.3)*.05,A.render(j,u)};$();const O=()=>{!r.current||!m.current||!x.current||(m.current.aspect=r.current.clientWidth/r.current.clientHeight,m.current.updateProjectionMatrix(),x.current.setSize(r.current.clientWidth,r.current.clientHeight))};return window.addEventListener("resize",O),()=>{var e,o,i;(e=r.current)==null||e.removeEventListener("mousemove",X),window.removeEventListener("resize",O),R.current&&cancelAnimationFrame(R.current),r.current&&((o=x.current)!=null&&o.domElement)&&r.current.removeChild(x.current.domElement),a.current.bars.forEach(t=>{t.geometry&&t.geometry.dispose(),t.material&&(Array.isArray(t.material)?t.material.forEach(h=>h.dispose()):t.material.dispose()),t.children.forEach(h=>{h instanceof I&&(h.geometry&&h.geometry.dispose(),h.material&&(Array.isArray(h.material)?h.material.forEach(g=>g.dispose()):h.material.dispose()))})}),a.current.particles&&(a.current.particles.geometry.dispose(),a.current.particles.material.dispose()),a.current.gridHelper&&(a.current.gridHelper.geometry.dispose(),a.current.gridHelper.material.dispose()),(i=x.current)==null||i.dispose()}},[p,M,y]),l.jsxs("div",{className:"relative",children:[l.jsx("div",{ref:r,className:"w-full rounded-xl overflow-hidden",style:{height:F}}),y>=0&&l.jsxs("div",{className:"absolute top-4 right-4 bg-surface-elevated border border-border-subtle rounded-lg px-4 py-2 shadow-lg",children:[l.jsx("div",{className:"text-xs text-text-muted",children:(d==null?void 0:d[y])||`Data Point ${y+1}`}),l.jsx("div",{className:"text-xl font-bold text-primary",children:p[y]})]}),l.jsx("div",{className:"flex justify-between mt-4 px-2",children:d==null?void 0:d.map((j,u)=>l.jsx("div",{className:`text-xs text-center transition-all ${u===y?"text-accent font-bold scale-110":"text-text-muted"}`,children:j},u))})]})},Me=({segments:p,size:d=200})=>{const M=s.useRef(null),F=s.useRef(null),r=s.useRef(null),y=s.useRef(null),N=s.useRef(null),w=s.useRef({meshes:[],lines:[],centerGlow:null}),x=s.useRef(0);return s.useEffect(()=>{var b;if(!M.current)return;const m=new J;F.current=m;const R=new K(50,1,.1,1e3);R.position.z=15,y.current=R;const a=new Q({antialias:!0,alpha:!0,powerPreference:"high-performance"});a.setSize(d,d),a.setPixelRatio(Math.min(window.devicePixelRatio,2)),M.current.appendChild(a.domElement),r.current=a;const v=new Z;m.add(v);const P=p.reduce((f,c)=>f+c.value,0);let E=0;const S=[],j=[];p.forEach(f=>{const c=f.value/P*Math.PI*2,n=new re,B=4,k=2.5;n.absarc(0,0,B,E,E+c,!1),n.absarc(0,0,k,E+c,E,!0);const W=new ne(n,{depth:.5,bevelEnabled:!1}),C=new z({color:new q(f.color),transparent:!0,opacity:.8}),G=new I(W,C);G.rotation.x=Math.PI/2,v.add(G),S.push(G);const L=new se(W),D=new ae({color:16777215,transparent:!0,opacity:.3}),H=new oe(L,D);H.rotation.x=Math.PI/2,v.add(H),j.push(H),E+=c}),w.current.meshes=S,w.current.lines=j;const u=new I(new ce(2,32),new z({color:new q(((b=p[0])==null?void 0:b.color)||"#6366f1"),transparent:!0,opacity:.3}));u.position.z=.26,v.add(u),w.current.centerGlow=u;const A=()=>{N.current=requestAnimationFrame(A),x.current+=.01,v.rotation.z=Math.sin(x.current*.5)*.1,u.scale.setScalar(1+Math.sin(x.current*2)*.05),a.render(m,R)};return A(),()=>{var f,c;N.current&&cancelAnimationFrame(N.current),M.current&&((f=r.current)!=null&&f.domElement)&&M.current.removeChild(r.current.domElement),w.current.meshes.forEach(n=>{n.geometry&&n.geometry.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(B=>B.dispose()):n.material.dispose())}),w.current.lines.forEach(n=>{n.geometry&&n.geometry.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(B=>B.dispose()):n.material.dispose())}),w.current.centerGlow&&(w.current.centerGlow.geometry.dispose(),w.current.centerGlow.material.dispose()),(c=r.current)==null||c.dispose()}},[p,d]),l.jsxs("div",{className:"flex flex-col items-center gap-6",children:[l.jsx("div",{ref:M,style:{width:d,height:d}}),l.jsx("div",{className:"grid grid-cols-2 gap-4",children:p.map((m,R)=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:m.color}}),l.jsx("span",{className:"text-sm text-text-muted",children:m.label}),l.jsxs("span",{className:"text-sm font-bold text-text-default",children:[m.value,"%"]})]},R))})]})};export{Me as Ring3DChart,ve as default};
